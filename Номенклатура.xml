<?xml version="1.0" encoding="utf-8"?>

<unit name="Номенклатура">
	
	<type name="Номенклатура" title="Номенклатура" scope="global">
		<field.string name="Код" width="10"/>
		<field.string name="Наименование" width="30"/>
		<field.number name="Цена" precision="2" width="10" align="right"/>
		<field.number name="Остаток" precision="3" width="10" align="right"/>
		
		<function name="title">
			<get field="Наименование"/>
		</function>

		<state name="ДобавитьВКорзину">
			<query>
				<insert into="Покупка">
					<put field="id" in="Номенклатура"/>
				</insert>
			</query>
			<function name="title">
				<get value="В корзине"/>
			</function>
		</state>
		
		<state name="ВКорзине">
			
		</state>

		<function name="ВКорзине">
			<seek>
				<get value="Покупка"/>
				<account/>
				<get field="id"/>
			</seek>
		</function>
		
		<index name="Номенклатура">
			<key field="Наименование"/>
		</index>
	</type>
	
	<form name="Номенклатура">
		<column width="2"/>
		<column width="20"/>
		<column width="30"/>
		
		<row/>
		<row indent="1" text="Наименование"/>
		<cell bind="Наименование" bold="1" wrap="1"/>
	
		<row/>
		<row indent="1" text="Цена"/>
		<cell bind="Цена"/>

		<row/>
		<row indent="2">
			<button name="ДобавитьВКорзину" text="Добавить в корзину"/>
		</row>
	</form>
	
	<form name="Номенклатура.ВКорзине">
		<column width="2"/>
		<column width="20"/>
		<column width="30"/>
		
		<row/>
		<row indent="1" text="Наименование"/>
		<cell bind="Наименование" bold="1" wrap="1"/>
	
		<row/>
		<row indent="1" text="Цена"/>
		<cell bind="Цена"/>

		<row/>
		<row indent="2" text="✅ В корзине" bold="1" color="00C000"/>
		
		<row/>
		<row indent="2">
			<link reference="Корзина" type="report" text="🛒 Перейти в корзину"/>
		</row>
	</form>
	
</unit>
